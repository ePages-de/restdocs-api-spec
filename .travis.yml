dist: focal
before_install:
  - sudo apt-get install -y openjdk-8-jdk
before_cache:
- rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock
- rm -fr $HOME/.gradle/caches/*/plugin-resolution/
cache:
  directories:
  - "$HOME/.gradle/caches/"
  - "$HOME/.gradle/wrapper/"
install: true
script: "./ci_build.sh"
deploy:
- provider: script
  script: "./ci_publish_java.sh"
  on:
    tags: true
  skip_cleanup: true
- provider: script
  script: "./ci_publish_gradle.sh"
  on:
    tags: true
  skip_cleanup: true
env:
  global:
  - CI_NAME=travis-ci
  - SIGNING_KEYRING_FILE="${TRAVIS_BUILD_DIR}/secret-keys.gpg"
  - JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64
  # coveralls
  - secure: "nOkY2AcR5Z7hKKzi+zCzmzPk+xiRRrJjGliDJnHnEO7g+iJ8SmT+thHuMFcXqvjxJ006LbR3GPB8M8qgFXFDPEUDRPppShi3waOm1ddlM2iXh9kbCoROoioyRO+F07deH6ExibkLbu/xq3WwAAw7lx/ZP+buc2R2VCbV0nLKP9iE4nHQX8msLgmU1LjWf0Au1Pgl2eWXV0J4/ZJOvcVu9hvBf1Ow4C7BNb0KZmMjeT9uMK0hiGpb9VVbwedOWfsbaFmqmKYqVKS8UtNmG+HBjvZfajrIARKRPc9w9uEvfl4E1H/J7PJLy2kOrCOauj8LMu6DduSrWcg08T5VnH51cavSAsWWG1ImTgEsUBNpllc9r1XLhQCLQ1TWCgGmleqYjZ2ySvg0MQpFjTgXMZC+aDkjZjcEeq3BgrncAR/bcG4ByrZBWyoEXDxBwoMZnkryTxK07UUgXRXdjJUldJ5CQW9oSfd+oEXKJyqQGNt0ob3S0sRS5uhrKniK+6Mwzxf6vXeYvn2fVP5j3hocUz4XzDJQoDDmJi6D4BpwksqJ81CNOHpyeDIOhdXxvA/J8DMCK0Q7tTSbnSOxItaht56CSxqqLSGax3/4Nr+5QX9jpmdJ03HdpP+MOuIl6dZCmE4/w1IFaFEfhpETPlnWZHl1BsOt7omDeW7yCttDq3Y1mXU="
  # gradle plugin portal
  - secure: "XZ4MKhQkOcOp7iRpq/DPJu4RkGs6+26ykgo1n+NZDJlamJ+hikW0JahBuJdi30z/JVnXcpbHkVfmUSrHyWg0irggtOB+E566pRw/iPzeH6ZRzs0gFYdWujPv7BTXDZzzfGck8gSnMFDStHK1MYOYNYc8T1hNytwPy4WygGwc8mcgdbda5TTJuI0gbNm+5gehjW+h5tjeR6UrUBSj2Gbx+/UdJ3oXPOHFFu0i4OuXTSkWZz7Dz1M7o9loJOUtHwKB5osm9+tUQqLiI9yRE4Z80ngOC8eoF7HqBKFydoezqE+DCxNg+Vy+RkkTpa+mvBD+k5bZ/7BeFmOQdzE61YM1/xN1CaAjjFEI0KEisZ3gycdnxUp7sLkBuCMPfuhix3Sqjt9ulEv4k1MRMsXBJ7Wpe+ZuovHuXFlu1ni6tU5pRs5BhCnXc+X7dDvaprJUbB1pSp6/Rjpf5nOIszVf/HkO6MmgMQkZLwlcu6I8QPnOCfkW8FJroyOTUr/MD/oPNVGRLvANZuyqqNtEc9g/Nt6f0qSvlkdEOVcgBlz95d8UbkhEYbYbB71gqOo+flhfgIDOWEXgkrGjY7p95g5R+VIKSBaXv36EYyNPVAQQ55riyPnDpU5JUnur6GZIY+jTuNS0Tp6tXhPksRcBNjKEUqfte8YqI8EvdZfzvloODsb+9Wk="
  # gradle plugin portal
  - secure: "nd2+OblPYu7qdG0D/lkbKMhoxaEm/U/IWQQ7HJYK5Yjt6f/JOgux0OIA/m+OO/3wtWDTbT+ihRekIcIU/x3ab4b1P1cwP1pMDsqc8O3Nqa8K79AGOYx5c3vZ7M5DBiLYKZDSM7VAaz0ol1uoY7Lo0jCMJQsf74U4o2xunrok5bf511cAJZ4gcczZ3hfoTu98gonil71Ln9TrdE9f86dX/aI7hmD9dajjxz98JkQSR/Cf47W4oAbBla85rHlDdzzrnGuVyhpV3r1ib2lrpcrBHID5IhSXyCEJxdbCNAlTCGuXdBMG+m99h9hYw7Nq1OsxbO2gmqs77fXmwKpPGwtf5PLGlQdkcExsdvNORmTeIn5Ac8JNDiEz8w/jrpBqkVZ5x6yVeSUe5VqAR1GLCrqIud2W3dDefWsSEhHtvu/iJYPB8IN01S55V7Uzy7hfs4Z6DnjPxT5khRleUViQywhFZ4/+yQ5OELeLbrGaDwZuZI2WOMahvgV749NrdCZ6SeIZSptr6ywCH7OFUJIbgiYvv0wxgpqg3cYeQ5OsUFR/+dWkXA+rk+17N7PodCAHl9Cg1ckg1N5H2AYAQzxn8mSELb2STRZpViygbiDeadrjnJBr8kFYdWkFc4fTX2CeboD7MitUjOWXvvQrlyU+R9BVaxs1cV8iTCLnP1dt0HKXKBA="
  # SONATYPE_USERNAME
  - secure: "IVEnzxQmCuquvSjHDI5Y82j6WKo+TRGoUFZBY1n/oX7H+aAcOAizVQjXS/usJp/lo7BR7Hpov6DmvfPyKNHh4uWR8x5gx32ibo8Wah385jdSADZ4uZS2mDwt+bw5pPnzANBL7CnXz5JQdHrws3Iz+47p4sWbDmwaLX+hi8CIza+jMiLO57cpMNcuMsf9Pv5C/y5Vp+RvjE16b4JlXcdfgkK1uQG2jP3jPi0AVgIj7jubiJNgbN6YzxwUe4lDFq42/hmnm2FIvuUaUPn5lkKvs5xBdJp7FMBlii+LUMB9aP7dQbXdKu/BJZ7yxY2hbdNfydPbRdwXICJzUM/mi37GWZD4TbXDHDd0Hh2HasLU23R8dy9rRmW+PajY0426zMkq7/NxUZhCIOhLjZloJjDV1hLDXfZgAnaw6k2ROgkJNjqbcwgNizF57IObU4+L+izLCPT27Z189Dw8oowjvgE0k9t/OqpBEwBh50ig9lh+/KU+JzmaiU5dNU7EddP6RicZeZBLjSrmaa+ZBZYfOTqvzrt6a8JThMaU14hFxwz6sOqiWyFKIzCVe6Hl30OkEdMgXT+r9r76Auxnc/1gY92Gc2bNkc6wQUHnREgHeHx8U8LF8RpxbAKs95SKA9CTFCEL1yX4nfnhyFHvtHuqD1nZ2WhHTWoAEOYxV+egZRxAcss="
  # SONATYPE_PASSWORD
  - secure: "BMBpvpai5dgR5bw0gKDDVkHoyx+USwwqYI1yDAF6QCCdZnJSAzXwSCsfPHYOVUo290YVbC8d7MCEWIE0LmhWflBOd437rLuNvK0MVcCCsDWJwNuYRJgs21ot1BCMw0zLFbFGaGsbcZ5Daau1SdU/lss1UnhVSvNcMs4vs2Hwv8qE7eksVZm4FTtVHsYvDwCO4DgGGAVlQ1VTpsMm5gqdHm5HLiuWm2I67RBoyurAdlroCbyFoxMovE2pHczMJSJXL8z8lMvXm9pJnFyYvm0gQLlzFiKLY7oKvTawolhcXgWJDncMrBcOOAPEDDhlbg5pUZbRdXwlIQN4AQjXVKUDtcFo3OWK2s7d17TQQWrCPrUfhLwyY9Bt3jqw/6gEKxT3bfiEgZCe2/QhYsfIBujgIrzJBKdIXRi0DvxFiExy2LTvQfClTeTZzxmNAVtELw1SDji1j5g8aQQZ1LDIsf84Dxwi0ptYgXsn4aM5v3xJVQ7ksZbSLawxhJflpaxaqlNPcHPm3aa7bLbA3herGR1J6oMlA5NZ+jxaigj1Mb2RVoOa4g1MbyPusZbqvK1oeBr2o72GIL1E2XzVpoSkD+G4qgb65rva1Ujb/XQ3Rojs8qDqelLeH6XfxXD7iSUdhGcBNihrb2Meht/Vr3kH+yFV7RbbD1k08BA5lVBArjhX3yI="
  # SIGNING_KEY_ID
  - secure: "fayTDjzNaVNUtTPZ/8VVWTOb2VgPHj1Kr4o65orYScEjwDkmRSquc9BcamrhWVlURxNeO927Bg9g3LC6Sjmj9jNi7YeGc9nwWuQGEtHLS6EAk8y6aRVg1HN9/gihljTo/syKRdQNO9+ZfMEU4FxCHaGQUg95k8R44Vwm0ijlCoEpSPEsTMMo9PigJ+ln/oQOD+aR7bOu5zSNDi+ZDFqQYr8C3dOYNtFtmyaV7+HLwT7xIdEJfeVSZ+j23wXBLqa6rbIO/SsEZJeTbzY+asBrdh6h7sCIfKPnphNw63dRg0yJed+XVv77HaH4/0iImCySnMoX/dBCxOnf0BArtsujzxjocgaTCmoMoU9QQAzrZl4lfKzPn0+92/sR4Jg6TSZv/vliGWpzCtB+Ic+v28Oe0OjOy8so3feEGDwjjUKNXOovQslo0T84OB/7MJRvAgRLWmcXbjdk8SizNZtr0mfmQ/vVoydZI0s12tLzp/SSAdY7vsw6en9PyCq/LpGSow6tI+lj6HSzHS6KsHeiSr55bRguzytaH7e1SpnsXY31uRT0wvyRi5DOPN8AbJWULKVn82PpC/EBqehRQbd4HuGaEzA5Fan9DxutHEgfZUVZWVnlzUyam+DoO/5zYhcc79UaJYr6IJpGP90gSUQqAJ55fV56jxRvlPrApGNtBUCLy6I="
  # SIGNING_PASSWORD
  - secure: "OP9Y18m1ASYbZN9blGPYf8/nyQeHHUqQDIm/8ZTmpIXWkR+2dA4pcQtMahpFeFduNsju2YbY9dqvzUvfEXwIZF6IeeQ+NJmRCBbdr0vGqx/4HHQY4vt9FZHpsfRcNjE8xmygCYNrQpdgl8VRFdPmcveB54eg3XMrNznDVLSSx/cVrqw+xcPa2162vcs8XziOgglHorJCRz7LAavIEz/hiR9/9FBPTEWCQqnMA1pJn0yfHZtd0ADw+s2tGtB+IJJ8RXYl2fYvS47gK6RISP/QYskXKZgb5qwzbMgaE9lxJ4gXh09D/YCfz1LK+VreVkLAk9PQUQnIpcAggPbRQI+U3ZC/tjEG00L7dGp8a+B8mo3wRWCNgNzr6Mrft5WJ8NEXPiwr1U1FSeM+Zum9ealYqW0wU+ks/79K3GeWZ2ZU/tF1cioh69KbSRtC2zW2s2gBFUgGb63P+7h/QlKDE9tAUBSht4oaYdVALSbvQEYJrWQEZO87+LH0YSaIu+8XuD+OSzgjfWqRWTBUYLKb56iA5978mMtwfQASAwjhQFxdpgHchaM7CUospq09+M3CA0N/OMz9Xr+xgEzej4r5is4bQH1IN87TE6XlKUhy2ZaV98mZ7bQtlPHVlVjslWA8ztgUHKjoK0q3Ob8ot8d3eaqKgAUY6zVoVqrYUf/obYR+yfE="